name: ipv6
total_length_field: total_length
fields:
  - name: ver_tc_fl
    type: bitfield
    group_size: 4
    fields:
      - name: version
        bits: 4
      - name: traffic_class
        bits: 8
      - name: flow_label
        bits: 20
  - name: payload_length
    type: fixed
    size: 2
    format: uint
  - name: next_header
    type: fixed
    size: 1
    format: uint
  - name: hop_limit
    type: fixed
    size: 1
    format: uint
  - name: src
    type: fixed
    size: 16
    format: ipv6
  - name: dst
    type: fixed
    size: 16
    format: ipv6
  - name: total_length
    type: computed
    expression: payload_length + 40

next_protocol:
  field: next_header
  mapping:
    6: tcp
    17: udp
    1: icmp
    58: icmpv6
    47: gre
